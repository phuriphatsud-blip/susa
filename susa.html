<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SOS Tasugete</title>
  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-4">

  <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ -->
  <h1 class="text-center text-danger mb-3">üö® SOS Tasugete</h1>

  <!-- ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà -->
  <div id="locationBox" class="alert alert-warning text-center fw-bold">
    üìç ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì...
  </div>

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏ó‡∏£‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô -->
  <div class="d-grid gap-3">
    <button class="btn btn-success btn-lg" onclick="confirmCall('üè• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•', '1669')">üè• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• (1669)</button>
    <button class="btn btn-primary btn-lg" onclick="confirmCall('üëÆ‚Äç‚ôÇÔ∏è ‡∏ï‡∏≥‡∏£‡∏ß‡∏à', '191')">üëÆ‚Äç‚ôÇÔ∏è ‡∏ï‡∏≥‡∏£‡∏ß‡∏à (191)</button>
    <button class="btn btn-danger btn-lg" onclick="confirmCall('üî• ‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ / ‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á', '199')">üî• ‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ / ‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á (199)</button>
    <button class="btn btn-warning btn-lg" onclick="confirmCall('üêç ‡∏á‡∏π‡πÄ‡∏Ç‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô / ‡∏Å‡∏π‡πâ‡∏†‡∏±‡∏¢', '1784')">üêç ‡∏á‡∏π‡πÄ‡∏Ç‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô / ‡∏Å‡∏π‡πâ‡∏†‡∏±‡∏¢ (1784)</button>
    <button class="btn btn-info btn-lg" onclick="confirmCall('üõ£Ô∏è ‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ó‡∏≤‡∏á‡∏´‡∏•‡∏ß‡∏á', '1193')">üõ£Ô∏è ‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏ó‡∏≤‡∏á‡∏´‡∏•‡∏ß‡∏á (1193)</button>
  </div>

  <!-- ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÇ‡∏ó‡∏£‡πÅ‡∏ö‡∏ö‡∏ã‡πà‡∏≠‡∏ô -->
  <a id="hiddenCallLink" style="display:none;"></a>

  <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≤‡∏¢ -->
  <footer class="text-center text-secondary mt-4 small">
    ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢ ‚Äî ‡πÇ‡∏ó‡∏£‡∏ü‡∏£‡∏µ 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
  </footer>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
function confirmCall(name, number) {
  if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏ó‡∏£‡πÑ‡∏õ‡∏¢‡∏±‡∏á ${name} ‡πÄ‡∏ö‡∏≠‡∏£‡πå ${number} ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
    const link = document.getElementById("hiddenCallLink");
    link.href = `tel:${number}`;
    link.click();
  }
}

async function showLocation() {
  const box = document.getElementById("locationBox");
  if (!navigator.geolocation) {
    box.classList.replace("alert-warning", "alert-danger");
    box.innerText = "‚ùó ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á";
    return;
  }

  navigator.geolocation.getCurrentPosition(async pos => {
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;

    try {
      const proxy = 'https://cors-anywhere.herokuapp.com/';
      const url = `https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${lat}&lon=${lon}&zoom=18`;
      const res = await fetch(proxy + url);
      const data = await res.json();

      const addr = data.address || {};
      const number = addr.house_number || "";
      const road = addr.road || "";
      const subdistrict = addr.suburb || addr.subdistrict || "";
      const district = addr.county || addr.district || "";
      const state = addr.state || "";
      const postcode = addr.postcode || "";

      box.classList.replace("alert-warning", "alert-success");
      box.innerHTML = `üìç ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà: <b>${number} ${road}, ${subdistrict}, ${district}, ${state} ${postcode}</b>`;
    } catch {
      box.classList.replace("alert-warning", "alert-danger");
      box.innerText = "‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ (CORS ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï)";
    }
  }, err => {
    box.classList.replace("alert-warning", "alert-danger");
    box.innerText = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏î‡πâ: " + err.message;
  });
}

window.addEventListener("load", showLocation);
</script>

</body>
</html>
